---
title: "bucket_1"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
trans <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0, 0.6912952461, 0.1523791977, 0.1563255562, 0, 0, 0, 0, 0, 0.3759560324, 0.1091599855, 0.110618689, 0.4042652932, 0, 0, 0, 0, 0.1484376919, 0.03675634475, 0.03135989592, 0.1035468196, 0.6798992478, 0, 0, 0, 0.0790380875, 0.01157589791, 0.005050209364, 0.03231070934, 0.07522382544, 0.7968012704, 0, 0, 0.06679385746, 0.004410013812, 0.001076986694, 0.007426029481, 0.01497790688, 0.06765123958, 0.8376639661, 0, 0.04731417011, 0.002539726542, 0.0003352429969, 0.001215162255, 0.00228969976, 0.01145724018, 0.06028316234, 0.8745655958, 0, 0, 0, 0, 0, 0, 0, 1), nrow=8)

trans  <- t(trans)
start <- matrix(c(0,1,0,0,0,0,0,0), nrow = 1)
for (i in 1:1000) {
  start <- start %*% trans
}
start



trans2 <- matrix(c(1, 0, 0, 0, 0, 0, 0, 0, 0.6805996465, 0.1500216133, 0.1693787402, 0, 0, 0, 0, 0, 0.3759560324, 0.1091599855, 0.110618689, 0.4042652932, 0, 0, 0, 0, 0.1484376919, 0.03675634475, 0.03135989592, 0.1035468196, 0.6798992478, 0, 0, 0, 0.0790380875, 0.01157589791, 0.005050209364, 0.03231070934, 0.07522382544, 0.7968012704, 0, 0, 0.06679385746, 0.004410013812, 0.001076986694, 0.007426029481, 0.01497790688, 0.06765123958, 0.8376639661, 0, 0.04731417011, 0.002539726542, 0.0003352429969, 0.001215162255, 0.00228969976, 0.01145724018, 0.06028316234, 0.8745655958, 0, 0, 0, 0, 0, 0, 0, 1), nrow=8)

trans2 <- t(trans2)
start2 <- matrix(c(0,1,0,0,0,0,0,0), nrow = 1)
for (i in 1:1000) {
  start2 <- start2 %*% trans2
}
start2


```
```{r}
times <- rep(NA,500000)
co.s <- rep(FALSE,500000)
use.this <- trans2

for (i in 1:500000) {
  pos = 2
  time = 0
  co = FALSE
  while (pos != 1 && pos != 8) {
    tt <- use.this[pos,]
    prob <- tt
    for (c in 2:8) {
      prob[c] <- prob[c] + prob[c-1]
    }
    ran <- runif(1)
    state <- 0
    for (k in 1:8) {
      state <- state + 1
      if(ran <= prob[k] || state == 8){
        break
      }
    }
    pos <- state
    time <- time + 1
  }
  times[i] <- time
  if (pos == 8){
    co.s[i] <- TRUE
  }
}

mean(times[co.s==TRUE])
mean(times[co.s==FALSE])

sum(co.s==TRUE)
```

```{r}
c <- 0
for (i in 1:10) {
  c <- i
  if (i == 5){
    break
  }
}


prob <- trans[4,]
for (c in 2:8) {
  prob[c] <- prob[c] + prob[c-1]
}
prob
trans[4,]
```


